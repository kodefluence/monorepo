package db

import (
	"database/sql"

	"github.com/kodefluence/monorepo/exception"
)

// ResultAdapter wrap sql result
type ResultAdapter struct {
	result sql.Result
}

// AdaptResult wrap default sql result
func AdaptResult(result sql.Result) Result {
	return &ResultAdapter{result: result}
}

// LastInsertId returns the integer generated by the database
// in response to a command. Typically this will be from an
// "auto increment" column when inserting a new row. Not all
// databases support this feature, and the syntax of such
// statements varies.
func (r *ResultAdapter) LastInsertId() (int64, exception.Exception) {
	ID, err := r.result.LastInsertId()
	if err != nil {
		return ID, exception.Throw(err)
	}

	return ID, nil
}

// RowsAffected returns the number of rows affected by an
// update, insert, or delete. Not every database or database
// driver may support this.
func (r *ResultAdapter) RowsAffected() (int64, exception.Exception) {
	ID, err := r.result.RowsAffected()
	if err != nil {
		return ID, exception.Throw(err)
	}

	return ID, nil
}
